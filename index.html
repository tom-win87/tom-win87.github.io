<!DOCTYPE html>
<html>
<head>
    <title>Page Title</title>
<h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br><h1>GDPR TCF v2 Implementation</h1><br>

//stub file
<script type="text/javascript">
    !function (t) { var e = {}; function n(r) { if (e[r]) return e[r].exports; var o = e[r] = { i: r, l: !1, exports: {} }; return t[r].call(o.exports, o, o.exports, n), o.l = !0, o.exports } n.m = t, n.c = e, n.d = function (t, e, r) { n.o(t, e) || Object.defineProperty(t, e, { enumerable: !0, get: r }) }, n.r = function (t) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(t, "__esModule", { value: !0 }) }, n.t = function (t, e) { if (1 & e && (t = n(t)), 8 & e) return t; if (4 & e && "object" == typeof t && t && t.__esModule) return t; var r = Object.create(null); if (n.r(r), Object.defineProperty(r, "default", { enumerable: !0, value: t }), 2 & e && "string" != typeof t) for (var o in t) n.d(r, o, function (e) { return t[e] }.bind(null, o)); return r }, n.n = function (t) { var e = t && t.__esModule ? function () { return t.default } : function () { return t }; return n.d(e, "a", e), e }, n.o = function (t, e) { return Object.prototype.hasOwnProperty.call(t, e) }, n.p = "", n(n.s = 3) }([function (t, e) { t.exports = function (t) { return "object" == typeof t ? null !== t : "function" == typeof t } }, function (t, e, n) { t.exports = !n(2)(function () { return 7 != Object.defineProperty({}, "a", { get: function () { return 7 } }).a }) }, function (t, e) { t.exports = function (t) { try { return !!t() } catch (t) { return !0 } } }, function (t, e, n) { "use strict"; n.r(e); n(4); !function () { if ("function" != typeof window.__tcfapi) { var t, e = [], n = window, r = n.document; !n.__tcfapi && function t() { var e = !!n.frames.__tcfapiLocator; if (!e) if (r.body) { var o = r.createElement("iframe"); o.style.cssText = "display:none", o.name = "__tcfapiLocator", r.body.appendChild(o) } else setTimeout(t, 5); return !e }() && (n.__tcfapi = function () { for (var n = arguments.length, r = new Array(n), o = 0; o < n; o++)r[o] = arguments[o]; if (!r.length) return e; if ("setGdprApplies" === r[0]) r.length > 3 && 2 === parseInt(r[1], 10) && "boolean" == typeof r[3] && (t = r[3], "function" == typeof r[2] && r[2]("set", !0)); else if ("ping" === r[0]) { var i = { gdprApplies: t, cmpLoaded: !1, apiVersion: "2.0" }; "function" == typeof r[2] && r[2](i, !0) } else e.push(r) }, n.addEventListener("message", function (t) { var e = "string" == typeof t.data, r = {}; try { r = e ? JSON.parse(t.data) : t.data } catch (t) { } var o = r.__tcfapiCall; o && n.__tcfapi(o.command, o.parameter, o.version, function (n, r) { var i = { __tcfapiReturn: { returnValue: n, success: r, callId: o.callId } }; e && (i = JSON.stringify(i)), t.source.postMessage(i, "*") }) }, !1)) } }() }, function (t, e, n) { var r = n(5).f, o = Function.prototype, i = /^\s*function ([^ (]*)/; "name" in o || n(1) && r(o, "name", { configurable: !0, get: function () { try { return ("" + this).match(i)[1] } catch (t) { return "" } } }) }, function (t, e, n) { var r = n(6), o = n(7), i = n(10), f = Object.defineProperty; e.f = n(1) ? Object.defineProperty : function (t, e, n) { if (r(t), e = i(e, !0), r(n), o) try { return f(t, e, n) } catch (t) { } if ("get" in n || "set" in n) throw TypeError("Accessors not supported!"); return "value" in n && (t[e] = n.value), t } }, function (t, e, n) { var r = n(0); t.exports = function (t) { if (!r(t)) throw TypeError(t + " is not an object!"); return t } }, function (t, e, n) { t.exports = !n(1) && !n(2)(function () { return 7 != Object.defineProperty(n(8)("div"), "a", { get: function () { return 7 } }).a }) }, function (t, e, n) { var r = n(0), o = n(9).document, i = r(o) && r(o.createElement); t.exports = function (t) { return i ? o.createElement(t) : {} } }, function (t, e) { var n = t.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(); "number" == typeof __g && (__g = n) }, function (t, e, n) { var r = n(0); t.exports = function (t, e) { if (!r(t)) return t; var n, o; if (e && "function" == typeof (n = t.toString) && !r(o = n.call(t))) return o; if ("function" == typeof (n = t.valueOf) && !r(o = n.call(t))) return o; if (!e && "function" == typeof (n = t.toString) && !r(o = n.call(t))) return o; throw TypeError("Can't convert object to primitive value") } }]);
</script>
//api stuff
<script>
__tcfapi('addEventListener', 2, function (tcData, success) {
           if (tcData.eventStatus === 'tcloaded' || tcData.eventStatus === 'useractioncomplete') {
               __tcfapi('getCustomVendorConsents', 2, (data) => console.log(data))
           }
       });



    __tcfapi('addEventListener', 2, (tcData, success) => {
        if (success) {
            console.log('tcData from event: ', tcData);
            const status = tcData.eventStatus;
            console.log("[DEBUG] TCF event", tcData.eventStatus)
            if (status === "tcloaded") {
                document.cookie=`tcloaded=${JSON.stringify(tcData)}`
                // __tcfapi('removeEventListener', 2, (success) => {
                //     console.log('Removed ', tcData.listenerId)
                // }, tcData.listenerId);
            }
            else if (status === 'cmpuishown') {
                document.cookie=`cmpuishown=${JSON.stringify(tcData)}`
                // __tcfapi('removeEventListener', 2, (success) => {
                //     console.log('Removed ', tcData.listenerId)
                // }, tcData.listenerId);
            }
            else if (status==='useractioncomplete') {
                document.cookie=`useractioncomplete=${JSON.stringify(tcData)}`;
                // __tcfapi('removeEventListener', 2, (success) => {
                //     console.log('Removed ', tcData.listenerId)
                // }, tcData.listenerId);
            }
        };
    });
    const findCookies = (name) => document.cookie.split('; ').find(r => r.startsWith(name)).split('=')[1]
    // __tcfapi('addEventListener', 2, (tcData, success) => {
    //     if (success) {
    //         const status = tcData.eventStatus;
    //         console.log("[DEBUG] TCF event", status)
    //     if (status === "cmpuloaded") {
    //         document.cookie=`cmpuloaded=${cmpuloaded}`
    //     }};
    // });
    // __tcfapi('addEventListener', 2, (tcData, success) => {
    //     if (success) {
    //         const status = tcData.eventStatus;
    //         console.log("[DEBUG] TCF event", status)
    //     if (status === "useractioncomplete") {
    //         document.cookie=`useractioncomplete=${useractioncomplete}`
    //     }};
    //     });

    let t1 = performance.now()
    let t2
    __tcfapi('getTCData', 2, (data) => {
        t2 = performance.now()
        console.log('TIME TAKE BY getTCData: ', t2 - t1)
        console.log(data)
    })
</script>


//user config snippet
<script>
        window._sp_ = {
            config: {
                accountId: 1584,
                baseEndpoint: 'https://cdn.privacy-mgmt.com',
                propertyId: 14578, //using template_test
                consentLanguage: "pl",
                events: {
                                onMessageReady: function () {
                                    console.log('onMessageReady')
                                },
                                onMessageChoiceSelect: function (choice_id, choice_type_id) {
                                    console.log('onMessageChoiceSelect choice_id: ', choice_id);
                                    console.log('onMessageChoiceSelect choice_id: ', choice_type_id);
                                },
                                onPrivacyManagerAction: function (pmData) {
                                    console.log('onPrivacyManagerAction', pmData)
                                },
                                onMessageChoiceError: function (err) {
                                    console.log('onMessageChoiceError', err)
                                },
                                onConsentReady: function (consentUUID, euconsent) {
                                    console.log('onConsentReady')
                                    console.log('consentUUID', consentUUID)
                                    console.log('euconsent', euconsent)
                                },
                                onPMCancel: function () {
                                    console.log('onPMCancel')
                                },
                                onMessageReceiveData: function (data) {
                                    console.log('onMessageReceiveData', data)
                                    console.log(JSON.stringify(data));
                                },
                                // onError: (code, error, userReset) => {
                                //         console.log(code)
                                //         console.log(error)
                                //         console.log(userReset)
                                //     },
                                onSPPMObjectReady: function () {
                                 //console.log('onSPPMObjectReady', window._sp_.loadPrivacyManagerModal)
                                // window._sp_.loadPrivacyManager(4400, '5d566301ab45d123ed973688')
                                }
                            },
                        }
                    }
</script>

//URL script
<script src="https://cdn.privacy-mgmt.com/wrapperMessagingWithoutDetection.js"></script>

</head>
<body>
<p>GDPR TCF v2 Implementation</p>
<a onclick="window._sp_.loadPrivacyManagerModal(492591);" href="javascript:void(0);">Load First Layer Message</a>
<span style="position: absolute; bottom: 0pt; left: 0pt;"></span> //to do FLM load you need to include it in a scenario and them make it live through campaign
<p></p>
<a onclick="window._sp_.loadPrivacyManagerModal(492965, 'purposes');" href="javascript:void(0);">Load PM</a>
<span style="position: absolute; bottom: 0pt; left: 0pt;"></span>
    <div></div> <div></div>
<img src="camera.jpg" alt="cam">
</body>
</html>
